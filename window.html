<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8"/>
    <title>NEZUU-GAME</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="icon" type="image/png" href="icon.png">
    <script src="library/jquery-3.5.1.min.js"></script>
    <script src="os.js"></script>
</head>
    
<body>
    <div class="header">
      <div class="header-logo">NEZUU-GAME</div>
      <div class="header-sub">CREATE BY NEZUU</div>
      <a href="https://twitter.com/nezuu2" id="btn">ãŠå•ã„åˆã‚ã›</a>
    </div>
    <nav>
        <ul>
          <li><a href="index.html" class="menu-active tabs-button">ãƒ›ãƒ¼ãƒ </a></li>
          <li><a href="javascript:alert('ç¾åœ¨é–‹ç™ºä¸­ã®ãŸã‚ã”é–²è¦§ã„ãŸã ã‘ã¾ã›ã‚“ã€‚\nç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ãŒã€å¾Œæ—¥ã”ç¢ºèªã„ãŸã ã‘ã‚‹ã¨ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚')" class="menu-active tabs-button">ä½œè€…ã«ã¤ã„ã¦</a></li>
          <li><a href="game.html" class="menu-active tabs-button">ã‚²ãƒ¼ãƒ </a></li>
          <li><a href="window.html" class="menu-active tabs-button">çª“OS</a></li>
        </ul>
    </nav>

    <div class="main">
      <canvas id="can">canvasãŒç¨¼åƒã—ã¦ã„ã¾ã›ã‚“ã€‚</canvas>
      <div>
          <a id="button">ğŸ†•</a>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.9/p5.min.js"></script>
    <script>
      const Y_AXIS = 1;
      const X_AXIS = 2;
      let canvas;
      let fireworks = [];
      let star = [];
    
      function windowResized() {
        resizeCanvas(document.documentElement.clientWidth, document.documentElement.clientHeight);
        this.preStar();
      }
    
      function setup() {
        // ã‚­ãƒ£ãƒ³ãƒã‚¹ã®è¨­å®š
        canvas = createCanvas(document.documentElement.clientWidth, document.documentElement.clientHeight);
        canvas.position(0, 0);
        canvas.style("z-index", "-1");
        colorMode(RGB);
        frameRate(60);
        this.preStar();
      }
    
      function draw() {
        // èƒŒæ™¯è‰²ã‚’è¨­å®š
        setGradient(0, 0, width, height, color(0, 0, 0), color(24, 32, 72), Y_AXIS);
        noStroke();
    
        // æ˜Ÿã‚’æã
        this.drawStar();
    
        // èŠ±ç«ã‚’æ‰“ã¡ä¸Šã’ã‚‹é–“éš”ã‚’èª¿æ•´
        if (0 === frameCount % 100) {
          // æ‰“ã¡ä¸ŠãŒã‚‹ã‚¹ãƒ”ãƒ¼ãƒ‰
          let speed = random(10, 30);
          fireworks.push(new FireWork(random(width), height, 0, speed, 0.98));
        }
    
        for (let fw of fireworks) {
          // æ‰“ã¡åˆ‡ã£ãŸèŠ±ç«ã‚’å‡¦ç†å¯¾è±¡ã‹ã‚‰å¤–ã™ï¼ˆé…åˆ—ã‹ã‚‰å‰Šé™¤ã™ã‚‹ï¼‰
          if (2 === fw.getType || 30000 < fw.getFrame) {
            fireworks = fireworks.filter((n) => n !== fw);
            continue;
          }
    
          // æ‰“ã¡ä¸Šã’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™
          fw.fire();
        }
      }
    
      class FireWork {
        // åˆæœŸè¨­å®š
        constructor(x, y, vx, vy, gv) {
          // ãƒ•ãƒ¬ãƒ¼ãƒ ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
          this.frame = 0;
          this.type = 0;
          this.next = 0;
          // èŠ±ç«ã®è‰²
          this.r = random(155) + 80;
          this.g = random(155) + 80;
          this.b = random(155) + 80;
          this.a = 255;
    
          // åˆæœŸä½ç½®
          this.x = x;
          this.y = y;
    
          // ç‰ã®å¤§ãã•
          this.w = random(10, 5);
    
          // æ‰“ã¡ä¸ŠãŒã‚‹é«˜ã•
          this.maxHeight = random(height / 6, height / 2);
          this.fireHeight = height - this.maxHeight;
    
          // é‡åŠ›
          this.vx = vx;
          this.vy = vy;
          this.gv = gv;
    
          // æ®‹åƒè¡¨ç¤ºç”¨é…åˆ—
          this.afterImages = [];
          // çˆ†ç™ºç”¨é…åˆ—
          this.explosions = [];
    
          // æ¶ˆãˆã¦ã‹ã‚‰çˆ†ç™ºã¾ã§ã®é…å»¶æ™‚é–“
          this.exDelay = random(10, 40);
          // çˆ†ç™ºã®å¤§ãã•
          this.large = random(5, 15);
          // çˆ†ç™ºã®ç‰ã®æ•°
          this.ball = random(20, 100);
          // çˆ†ç™ºã‹ã‚‰æ¶ˆãˆã‚‹ã¾ã§ã®é•·ã•
          this.exend = random(20, 40);
          // çˆ†ç™ºã®ãƒ–ãƒ¬ãƒ¼ã‚­
          this.exStop = 0.96;
        }
    
        get getFrame() {
          return this.frame;
        }
    
        get getType() {
          return this.type;
        }
    
        // å‡¦ç†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«
        fire() {
          // 0:æ‰“ã¡ä¸Šã’ï¼ˆåˆæœŸï¼‰ 1:çˆ†ç™º
          switch (this.type) {
            case 0:
              this.rising();
              break;
            case 1:
              this.explosion();
              break;
          }
        }
    
        // æ‰“ã¡ä¸Šã’ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        rising() {
          // é ‚ç‚¹ã¾ã§é”ã—ãŸã‚‰æ¶ˆã™
          if (this.y * 0.8 < this.maxHeight) {
            this.a = this.a - 6;
          }
    
          // æŒ‡å®šã®é«˜ã•ã¾ã§ä¸Šæ˜‡ã™ã‚‹
          this.x += this.vx;
          this.y -= this.vy * ((this.fireHeight - (height - this.y)) / this.fireHeight);
    
          // æ®‹åƒã‚’è¡¨ç¤º
          this.afterImages.push(new Afterimage(this.r, this.g, this.b, this.x, this.y, this.w, this.a));
          for (let ai of this.afterImages) {
            if (ai.getAlpha <= 0) {
              this.afterImages = this.afterImages.filter((n) => n !== ai);
              continue;
            }
            ai.rsImage();
          }
    
          // æ‰“ã¡ä¸Šã’è¡¨ç¤º
          this.update(this.x, this.y, this.w);
    
          // å…¨ã¦ã®è¡¨ç¤ºãŒæ¶ˆãˆãŸã‚‰å‡¦ç†ã®ç¨®é¡ã‚’å¤‰æ›´ã™ã‚‹
          if (0 == this.afterImages.length) {
            if (0 === this.next) {
              // æ¶ˆãˆã¦ã‹ã‚‰çˆ†ç™ºã¾ã§é…å»¶ã•ã›ã‚‹
              this.next = this.frame + Math.round(this.exDelay);
            } else if (this.next === this.frame) {
              // èŠ±ç«ã®å¤§ãã•
              for (let i = 0; i < this.ball; i++) {
                // çˆ†ç™ºã®è§’åº¦
                let r = random(0, 360);
                // èŠ±ç«ã®å†…å´ã‚’ä½œã‚‹ï¼ˆãƒãƒ©ãƒãƒ©ï¼‰
                let s = random(0.1, 0.9);
                let vx = Math.cos((r * Math.PI) / 180) * s * this.large;
                let vy = Math.sin((r * Math.PI) / 180) * s * this.large;
                this.explosions.push(new FireWork(this.x, this.y, vx, vy, this.exStop));
                // èŠ±ç«ã®è¼ªéƒ­ã‚’ä½œã‚‹ï¼ˆä¸¸ããªã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰
                let cr = random(0, 360);
                let cs = random(0.9, 1);
                let cvx = Math.cos((cr * Math.PI) / 180) * cs * this.large;
                let cvy = Math.sin((cr * Math.PI) / 180) * cs * this.large;
                this.explosions.push(new FireWork(this.x, this.y, cvx, cvy, this.exStop));
              }
              this.a = 255;
              this.type = 1;
            }
          }
        }
    
        // çˆ†ç™ºã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
        explosion() {
          for (let ex of this.explosions) {
            ex.frame++;
            // çˆ†ç™ºã—çµ‚ã‚ã£ãŸèŠ±ç«ã‚’é…åˆ—ã‹ã‚‰é™¤å»ã™ã‚‹
            if (2 === ex.getType) {
              this.explosions = this.explosions.filter((n) => n !== ex);
              continue;
            }
    
            // æ®‹åƒã‚’æç”»
            if (0 === Math.round(random(0, 32))) {
              ex.afterImages.push(new Afterimage(this.r, this.g, this.b, ex.x, ex.y, ex.w, ex.a));
            }
    
            for (let ai of ex.afterImages) {
              if (ai.getAlpha < 0) {
                ex.afterImages = ex.afterImages.filter((n) => n !== ai);
                continue;
              }
              ai.exImage();
            }
    
            // çˆ†ç™ºã‚’æç”»
            this.update(ex.x, ex.y, ex.w, ex.a);
            ex.x += ex.vx;
            ex.y += ex.vy;
            ex.vx = ex.vx * ex.gv;
            ex.vy = ex.vy * ex.gv;
            ex.vy = ex.vy + ex.gv / 30;
            if (this.exend < ex.frame) {
              ex.w -= 0.1;
              ex.a = ex.a - 4;
              if (ex.a < 0 && 0 === ex.afterImages.length) {
                ex.type = 2;
              }
            }
          }
        }
    
        // èŠ±ç«ã‚’è¡¨ç¤ºã™ã‚‹
        update(x, y, w, a) {
          this.frame++;
          if (0 < this.a) {
            let c = color(this.r, this.g, this.b);
            c.setAlpha(a);
            fill(c);
            ellipse(x, y, w, w);
          }
        }
      }
    
      // æ®‹åƒå‡¦ç†ç”¨ã‚¯ãƒ©ã‚¹
      class Afterimage {
        constructor(r, g, b, x, y, w, a) {
          this.frame = 0;
          this.r = r;
          this.g = g;
          this.b = b;
          this.x = x;
          this.y = y;
          this.w = w;
          this.a = a;
          this.vx = random(-0.24, 0.24);
          this.vy = random(0.2, 0.8);
          this.vw = random(0.05, 0.2);
        }
    
        get getAlpha() {
          return this.a;
        }
    
        // æ‰“ã¡ä¸Šã’ç”¨
        rsImage() {
          if (0 < this.a) {
            this.update(this.r, this.g, this.b, this.x, this.y, this.w, this.a);
            this.r += 4;
            this.g += 4;
            this.b += 4;
            this.x = this.x + this.vx;
            this.y = this.y + this.vy;
            if (0 < this.w) {
              this.w = this.w - this.vw;
            }
            this.a = this.a - 4;
          }
        }
    
        // çˆ†ç™ºç”¨
        exImage() {
          if (0 < this.a) {
            this.update(this.r, this.g, this.b, this.x, this.y, this.w, this.a);
            this.r += 2.5;
            this.g += 2.5;
            this.b += 2.5;
            this.x = this.x + this.vx;
            this.y = this.y + this.vy;
            if (0 < this.w) {
              this.w = this.w - this.vw;
            }
            this.a = this.a - 1.5;
          }
        }
    
        update(r, g, b, x, y, w, a) {
          this.frame++;
          let c = color(r, g, b);
          c.setAlpha(a);
          fill(c);
          ellipse(x, y, w, w);
        }
      }
    
      // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æç”»
      function setGradient(x, y, w, h, c1, c2, axis) {
        noFill();
    
        if (axis === Y_AXIS) {
          // Top to bottom gradient
          for (let i = y; i <= y + h; i++) {
            let inter = map(i, y, y + h, 0, 1);
            let c = lerpColor(c1, c2, inter);
            stroke(c);
            line(x, i, x + w, i);
          }
        } else if (axis === X_AXIS) {
          // Left to right gradient
          for (let i = x; i <= x + w; i++) {
            let inter = map(i, x, x + w, 0, 1);
            let c = lerpColor(c1, c2, inter);
            stroke(c);
            line(i, y, i, y + h);
          }
        }
      }
    
      // æ˜Ÿã‚’ä½œæˆ
      function preStar() {
        star = [];
        for (let i = 0; i < 100; i++) {
          star.push([random(width), random(height / 2), random(1, 4)]);
        }
      }
    
      // æ˜Ÿã‚’æç”»
      function drawStar() {
        // æ˜Ÿã‚’æã
        for (let s of star) {
          let c = color(random(150, 255), random(150, 255), 255);
          c.setAlpha(random(150, 200));
          fill(c);
          ellipse(s[0], s[1], s[2], s[2]);
        }
      }
    
    </script>
</body>
</html>
